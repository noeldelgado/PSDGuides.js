(function(e,t){"use strict";function u(e){o.extend(e),u.prototype.init()}e.PSDGuides=u;var n=e.document,r=document.getElementsByTagName("body")[0],i={show:!0,canvas:r,canvasWidth:0,orientation:"center",backColor:"rgba(132, 170, 234, 0.25)",lineColor:"rgba(73, 141, 255, 1)",xGuides:{},yGuides:{},zindex:9999},s={},o={};u.prototype={init:function(){this.drawUI(),this.bindEvents(),this.draw()},bindEvents:function(){o.addEvent(e,"resize",function(){i.show&&u.prototype.draw()}),o.addEvent(s.toggler,"click",function(){return s.wrapper.style.display!="none"?(s.wrapper.style.display="none",s.toggler.innerHTML=s.toggler.textOff,i.show=!1):(s.wrapper.style.display="",s.toggler.innerHTML=s.toggler.textOn,i.show=!0,u.prototype.draw()),!1})},drawUI:function(){var e;s.toggler=document.createElement("span"),e=s.toggler.style,s.toggler.textOn="Hide PSDGuides.js",s.toggler.textOff="Show PSDGuides.js",e.position="fixed",e.right="10px",e.top="10px",e.padding="5px 10px",e.border="1px solid #000",e.backgroundColor="rgba(0, 0, 0, 0.7)",e.borderRadius="3px",e.color="#f0f0f0",e.fontFamily="'Helvetica Neue', Helvetica, Arial, sans-serif",e.fontSize="11px",e.fontWeight="bold",e.zIndex=i.zindex+1,e.cursor="pointer",s.toggler.innerHTML=i.show?s.toggler.textOn:s.toggler.textOff,s.toggler.setAttribute("id","psdguide-ui"),r.appendChild(s.toggler)},draw:function(){var e;this.clearAll(),s.wrapper=document.createElement("div"),e=s.wrapper.style,e.position="absolute",e.top=0,e.width="100%",e.height=o.getHeight()+"px",e.zIndex=i.zindex,e.backgroundColor=i.backColor,s.wrapper.setAttribute("id","psGuidesWrapper"),r.appendChild(s.wrapper),i.show||(e.display="none"),o.isObjEmpty(i.yGuides)||this.drawYLines(),o.isObjEmpty(i.xGuides)||this.drawXLines()},drawYLines:function(){var e=document.createDocumentFragment(),t=0,n=null;s.yContainer=document.createElement("div"),n=s.yContainer.style,n.position="absolute",n.top=0,n.height="100%",n.width="100%",i.yGuides.map(function(n,r){var s;if(typeof n=="string"&&n.indexOf("*")!==-1){var o=n.replace(/[()\s]/g,"").split(/[,*]/g),u=0,a=o.length-1,f=o[o.length-1];for(;u<f;u+=1)o.map(function(n,r){if(r===a)return;s=document.createElement("div"),s.style.height=n-1+"px",s.style.borderBottom="1px dotted "+i.lineColor,t+=parseInt(n,10),e.appendChild(s)})}else s=document.createElement("div"),s.style.height=n-1+"px",s.style.borderBottom="1px dotted "+i.lineColor,t+=parseInt(n,10),e.appendChild(s)}),t=Math.max(r.clientHeight,t),s.wrapper.style.height=t,s.yContainer.appendChild(e),s.wrapper.appendChild(s.yContainer)},drawXLines:function(){var e=document.createDocumentFragment(),t=i.canvasWidth>0?i.canvasWidth:o.getWidth(),n=0,r=o.getOrientation(t),u=null;s.xContainer=document.createElement("div"),u=s.xContainer.style,u.position="fixed",u.top=0,u.height="100%",u.width=t-2+"px",u.marginLeft=r+"px",u.borderLeft="1px dotted "+i.lineColor,u.borderRight="1px dotted "+i.lineColor;while(n<t)i.xGuides.map(function(r,s){var o;if(typeof r=="string"&&r.indexOf("*")!==-1){var u=r.replace(/[()\s]/g,"").split(/[,*]/g),a=0,f=u.length-1,l=u[u.length-1];for(;a<l;a+=1)u.map(function(r,s){if(s===f)return;o=document.createElement("div"),o.style.left=n+"px",n+=parseInt(r,10),n<t&&(o.style.position="absolute",o.style.height="100%",o.style.width=parseInt(r,10)-1+"px",o.style.borderRight="1px dotted "+i.lineColor,e.appendChild(o))})}else o=document.createElement("div"),o.style.left=n+"px",n+=parseInt(r,10),n<t&&(o.style.position="absolute",o.style.height="100%",o.style.width=parseInt(r,10)-1+"px",o.style.borderRight="1px dotted "+i.lineColor,e.appendChild(o))});s.xContainer.appendChild(e),s.wrapper.appendChild(s.xContainer)},clearAll:function(){var e=document.getElementById("psGuidesWrapper");e!==null&&r.removeChild(e)}},o.extend=function(e){var t;for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t])},o.addEvent=function(t,n,r){t.addEventListener?t.addEventListener(n,r,!1):t.attachEvent&&(t["e"+n+r]=r,t[n+r]=function(){t["e"+n+r](e.event)},t.attachEvent("on"+n,t[n+r]))},o.getHeight=function(){return Math.max(Math.max(r.scrollHeight,n.documentElement.scrollHeight),Math.max(r.offsetHeight,n.documentElement.offsetHeight),Math.max(r.clientHeight,n.documentElement.clientHeight))},o.getWidth=function(){return Math.max(Math.max(r.scrollWidth,n.documentElement.scrollWidth),Math.max(r.offsetWidth,n.documentElement.offsetWidth),Math.max(r.clientWidth,n.documentElement.clientWidth))},o.isObjEmpty=function(e){return Object.getOwnPropertyNames(e).length===0?!0:!1},o.getOrientation=function(e){var t;switch(i.orientation){case"center":t=Math.floor((o.getWidth()-e)/2);break;case"left":t=0;break;case"right":t=Math.floor(o.getWidth()-e);break;default:t=Math.floor((o.getWidth()-e)/2)}return t}})(window)
